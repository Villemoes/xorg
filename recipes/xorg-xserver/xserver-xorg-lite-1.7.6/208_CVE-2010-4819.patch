Description: fix denial of service or possible memory leak
Origin: upstream, http://cgit.freedesktop.org/xorg/xserver/commit/?id=5725849a1b427cd4a72b84e57f211edb35838718
Bug: https://bugs.freedesktop.org/show_bug.cgi?id=28801

diff -Nur xorg-server-1.7.6/render/render.c xorg-server-1.7.6.new/render/render.c
--- xorg-server-1.7.6/render/render.c	2010-03-11 23:38:23.000000000 -0500
+++ xorg-server-1.7.6.new/render/render.c	2011-10-14 06:11:44.358604271 -0400
@@ -1085,6 +1085,14 @@
     gi = (xGlyphInfo *) (gids + nglyphs);
     bits = (CARD8 *) (gi + nglyphs);
     remain -= (sizeof (CARD32) + sizeof (xGlyphInfo)) * nglyphs;
+
+    /* protect against bad nglyphs */
+    if (gi < stuff || gi > ((CARD32 *)stuff + client->req_len) ||
+        bits < stuff || bits > ((CARD32 *)stuff + client->req_len)) {
+        err = BadLength;
+        goto bail;
+    }
+
     for (i = 0; i < nglyphs; i++)
     {
 	size_t padded_width;
